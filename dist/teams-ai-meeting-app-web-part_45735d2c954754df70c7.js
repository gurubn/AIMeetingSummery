define("a1b2c3d4-e5f6-789a-bcde-f0123456789a_0.0.1",["@microsoft/sp-property-pane","@microsoft/sp-core-library","@microsoft/sp-webpart-base","TeamsAiMeetingAppWebPartStrings"],function(n,a,i,r){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="owX6")}({"26ea":function(e,t){e.exports=n},JPst:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n,a,i,r=e[1]||"",o=e[3];if(!o)return r;if(t&&"function"==typeof btoa){var s=(n=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(i," */")),c=o.sources.map(function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")});return[r].concat(c).concat([s]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n}).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(a)for(var r=0;r<this.length;r++){var o=this[r][0];null!=o&&(i[o]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);a&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},UWqr:function(e,t){e.exports=a},UxGz:function(e,t,n){"use strict";(function(e){var n,a,i=this&&this.__assign||function(){return i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},i.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ClearStyleOptions=t.Mode=void 0,t.loadStyles=function(e,t){void 0===t&&(t=!1),u(function(){var a=Array.isArray(e)?e:b(e),i=c.runState,r=i.mode,o=i.buffer,s=i.flushTimer;t||r===n.async?(o.push(a),s||(c.runState.flushTimer=self.setTimeout(function(){c.runState.flushTimer=0,f()},0))):p(a)})},t.configureLoadStyles=function(e){c.loadStyles=e},t.configureRunMode=function(e){c.runState.mode=e},t.flush=f,t.loadTheme=function(e){c.theme=e;var t=document.body.style;for(var n in e)e.hasOwnProperty(n)&&t.setProperty("--".concat(n),e[n]);!function(){if(c.theme){for(var e=[],t=0,n=c.registeredThemableStyles;t<n.length;t++){var i=n[t];e.push(i.themableStyle)}e.length>0&&(m(a.onlyThemable),p([].concat.apply([],e)))}}()},t.replaceTokensWithVariables=function(e){return e.replace(d,function(e,t,n){return"string"==typeof n?"var(--".concat(t,", ").concat(n,")"):"var(--".concat(t,")")})},t.clearStyles=m,t.detokenize=function(e){return e&&(e=h(b(e)).styleString),e},t.splitStyles=b,function(e){e[e.sync=0]="sync",e[e.async=1]="async"}(n||(t.Mode=n={})),function(e){e[e.onlyThemable=1]="onlyThemable",e[e.onlyNonThemable=2]="onlyNonThemable",e[e.all=3]="all"}(a||(t.ClearStyleOptions=a={}));var r,o="undefined"==typeof window?e:window,s=o&&o.CSPSettings&&o.CSPSettings.nonce,c=((r=o.__themeState__||{theme:void 0,lastStyleElement:void 0,registeredStyles:[]}).runState||(r=i(i({},r),{perf:{count:0,duration:0},runState:{flushTimer:0,mode:n.sync,buffer:[]}})),r.registeredThemableStyles||(r=i(i({},r),{registeredThemableStyles:[]})),o.__themeState__=r,r),d=/[\'\"]\[theme:\s*(\w+)\s*(?:\,\s*default:\s*([\\"\']?[\.\,\(\)\#\-\s\w]*[\.\,\(\)\#\-\w][\"\']?))?\s*\][\'\"]/g,l=function(){return"undefined"!=typeof performance&&performance.now?performance.now():Date.now()};function u(e){var t=l();e();var n=l();c.perf.duration+=n-t}function f(){u(function(){var e=c.runState.buffer.slice();c.runState.buffer=[];var t=[].concat.apply([],e);t.length>0&&p(t)})}function p(e,t){c.loadStyles?c.loadStyles(h(e).styleString,e):function(e){if("undefined"!=typeof document){var t=document.getElementsByTagName("head")[0],n=document.createElement("style"),a=h(e),i=a.styleString,r=a.themable;n.setAttribute("data-load-themed-styles","true"),s&&n.setAttribute("nonce",s),n.appendChild(document.createTextNode(i)),c.perf.count++,t.appendChild(n);var o=document.createEvent("HTMLEvents");o.initEvent("styleinsert",!0,!1),o.args={newStyle:n},document.dispatchEvent(o);var d={styleElement:n,themableStyle:e};r?c.registeredThemableStyles.push(d):c.registeredStyles.push(d)}}(e)}function m(e){void 0===e&&(e=a.all),e!==a.all&&e!==a.onlyNonThemable||(_(c.registeredStyles),c.registeredStyles=[]),e!==a.all&&e!==a.onlyThemable||(_(c.registeredThemableStyles),c.registeredThemableStyles=[])}function _(e){e.forEach(function(e){var t=e&&e.styleElement;t&&t.parentElement&&t.parentElement.removeChild(t)})}function h(e){var t=c.theme,n=!1;return{styleString:(e||[]).map(function(e){var a=e.theme;if(a){n=!0;var i=t?t[a]:void 0,r=e.defaultValue||"inherit";return t&&!i&&console,i||r}return e.rawString}).join(""),themable:n}}function b(e){var t=[];if(e){for(var n=0,a=void 0;a=d.exec(e);){var i=a.index;i>n&&t.push({rawString:e.substring(n,i)}),t.push({theme:a[1],defaultValue:a[2]}),n=d.lastIndex}t.push({rawString:e.substring(n)})}return t}}).call(this,n("yLpj"))},ZYE7:function(e,t,n){(t=n("JPst")(!1)).push([e.i,'.teamsAiMeetingApp_b4714f94 .container_b4714f94{background-color:"[theme:white, default: #ffffff]";border-radius:8px;box-shadow:0 2px 4px 0 rgba(0,0,0,.2),0 25px 50px 0 rgba(0,0,0,.1);margin:0 auto;max-width:700px;padding:24px}.teamsAiMeetingApp_b4714f94 .row_b4714f94{zoom:1;background-color:"[theme:themeDark, default: #005a9e]";border-radius:8px 8px 0 0;box-sizing:border-box;color:"[theme:white, default: #ffffff]";margin:0 -8px;margin:-24px -24px 24px -24px;padding:20px}.teamsAiMeetingApp_b4714f94 .row_b4714f94:after,.teamsAiMeetingApp_b4714f94 .row_b4714f94:before{content:"";display:table;line-height:0}.teamsAiMeetingApp_b4714f94 .row_b4714f94:after{clear:both}.teamsAiMeetingApp_b4714f94 .column_b4714f94{box-sizing:border-box;min-height:1px;padding-left:8px;padding-right:8px;position:relative}[dir=ltr] .teamsAiMeetingApp_b4714f94 .column_b4714f94{float:left}[dir=rtl] .teamsAiMeetingApp_b4714f94 .column_b4714f94{float:right}.teamsAiMeetingApp_b4714f94 .column_b4714f94 .ms-Grid_b4714f94{padding:0}@media (min-width:640px){.teamsAiMeetingApp_b4714f94 .column_b4714f94{width:83.3333333333%}}@media (min-width:1024px){.teamsAiMeetingApp_b4714f94 .column_b4714f94{width:66.6666666667%}[dir=ltr] .teamsAiMeetingApp_b4714f94 .column_b4714f94{left:16.6666666667%}[dir=rtl] .teamsAiMeetingApp_b4714f94 .column_b4714f94{right:16.6666666667%}}@media (min-width:640px){[dir=ltr] .teamsAiMeetingApp_b4714f94 .column_b4714f94{left:8.3333333333%}[dir=rtl] .teamsAiMeetingApp_b4714f94 .column_b4714f94{right:8.3333333333%}}.teamsAiMeetingApp_b4714f94 .header_b4714f94{margin-bottom:24px;text-align:center}.teamsAiMeetingApp_b4714f94 .title_b4714f94{color:"[theme:white, default: #ffffff]";display:block;font-size:21px;font-weight:100;font-weight:600;margin-bottom:8px}.teamsAiMeetingApp_b4714f94 .subTitle_b4714f94{color:"[theme:white, default: #ffffff]";font-size:17px;font-weight:300;margin:0;opacity:.9}.teamsAiMeetingApp_b4714f94 .meetingInfo_b4714f94{color:"[theme:white, default: #ffffff]";font-family:Courier New,monospace;font-size:14px;font-weight:400;margin:8px 0 0 0;opacity:.8}.teamsAiMeetingApp_b4714f94 .content_b4714f94{background-color:"[theme:white, default: #ffffff]";border-radius:8px;margin:-24px;padding:24px}.teamsAiMeetingApp_b4714f94 .section_b4714f94{margin-bottom:32px}.teamsAiMeetingApp_b4714f94 .section_b4714f94 h3{border-bottom:2px solid;color:"[theme:themeDark, default: #005a9e]";font-size:17px;font-weight:300;font-weight:600;margin:0 0 16px 0;padding-bottom:8px}.teamsAiMeetingApp_b4714f94 .section_b4714f94 h4{color:"[theme:themeDark, default: #005a9e]";font-size:14px;font-weight:400;font-weight:600;margin:0 0 12px 0}.teamsAiMeetingApp_b4714f94 .statusIndicator_b4714f94{-ms-flex-align:center;align-items:center;background-color:"[theme:greenLight, default: #bad80a]";border-left:4px solid;border-radius:6px;display:-ms-flexbox;display:flex;gap:8px;padding:12px}.teamsAiMeetingApp_b4714f94 .statusDot_b4714f94{border-radius:50%;height:12px;width:12px}.teamsAiMeetingApp_b4714f94 .statusDot_b4714f94.active_b4714f94{animation:pulse_b4714f94 2s infinite;background-color:"[theme:green, default: #107c10]"}@keyframes pulse_b4714f94{0%{opacity:1}50%{opacity:.5}to{opacity:1}}.teamsAiMeetingApp_b4714f94 .transcriptionPanel_b4714f94{background-color:"[theme:neutralLighter, default: #f4f4f4]";border:1px solid;border-radius:6px;padding:16px}.teamsAiMeetingApp_b4714f94 .status_b4714f94{background-color:"[theme:white, default: #ffffff]";border-left:4px solid;border-radius:4px;color:"[theme:neutralDark, default: #212121]";font-size:14px;font-weight:400;margin-bottom:16px;padding:8px}.teamsAiMeetingApp_b4714f94 .button_b4714f94{border:none;border-radius:4px;cursor:pointer;font-size:14px;font-weight:600;padding:12px 24px;transition:all .2s ease}.teamsAiMeetingApp_b4714f94 .button_b4714f94.primary_b4714f94{background-color:"[theme:themePrimary, default: #0078d4]";color:"[theme:white, default: #ffffff]"}.teamsAiMeetingApp_b4714f94 .button_b4714f94.primary_b4714f94:hover{background-color:"[theme:themeDark, default: #005a9e]"}.teamsAiMeetingApp_b4714f94 .button_b4714f94.primary_b4714f94:disabled{background-color:"[theme:neutralLight, default: #eaeaea]";color:"[theme:neutralDark, default: #212121]";cursor:not-allowed}.teamsAiMeetingApp_b4714f94 .summaryPanel_b4714f94{background-color:"[theme:neutralLighter, default: #f4f4f4]";border:1px solid;border-radius:6px;min-height:200px;padding:16px}.teamsAiMeetingApp_b4714f94 .summaryContent_b4714f94{background-color:"[theme:white, default: #ffffff]";border-radius:4px;font-size:12px;font-weight:400;line-height:1.5;min-height:150px;padding:16px}.teamsAiMeetingApp_b4714f94 .loading_b4714f94{-ms-flex-align:center;-ms-flex-pack:center;align-items:center;display:-ms-flexbox;display:flex;gap:12px;justify-content:center;padding:24px}.teamsAiMeetingApp_b4714f94 .loading_b4714f94 .spinner_b4714f94{animation:spin_b4714f94 1s linear infinite;border:2px solid;border-radius:50%;border-top:2px solid;height:20px;width:20px}@keyframes spin_b4714f94{0%{transform:rotate(0)}to{transform:rotate(1turn)}}.teamsAiMeetingApp_b4714f94 .summaryFormatted_b4714f94 .summarySection_b4714f94{margin-bottom:24px}.teamsAiMeetingApp_b4714f94 .summaryFormatted_b4714f94 .summarySection_b4714f94 h4{-ms-flex-align:center;align-items:center;color:"[theme:themeDark, default: #005a9e]";display:-ms-flexbox;display:flex;font-size:14px;font-weight:400;font-weight:600;gap:8px;margin:0 0 12px 0}.teamsAiMeetingApp_b4714f94 .summaryFormatted_b4714f94 .summarySection_b4714f94 p{font-size:12px;font-weight:400;line-height:1.6;margin:0 0 8px 0}.teamsAiMeetingApp_b4714f94 .summaryFormatted_b4714f94 .summarySection_b4714f94 ul{margin:0;padding-left:20px}.teamsAiMeetingApp_b4714f94 .summaryFormatted_b4714f94 .summarySection_b4714f94 ul li{font-size:12px;font-weight:400;line-height:1.5;margin-bottom:4px}.teamsAiMeetingApp_b4714f94 .actionItems_b4714f94{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;gap:12px}.teamsAiMeetingApp_b4714f94 .actionItem_b4714f94{background-color:"[theme:neutralLighter, default: #f4f4f4]";border-left:4px solid;border-radius:4px;padding:12px}.teamsAiMeetingApp_b4714f94 .actionItem_b4714f94 strong{color:"[theme:neutralDark, default: #212121]";font-size:12px;font-weight:400}.teamsAiMeetingApp_b4714f94 .actionItem_b4714f94 .assignee_b4714f94{color:"[theme:themePrimary, default: #0078d4]";font-size:11px;font-weight:400;font-weight:600}.teamsAiMeetingApp_b4714f94 .actionItem_b4714f94 .dueDate_b4714f94{color:"[theme:orange, default: #d83b01]";font-size:11px;font-weight:400;font-weight:600}.teamsAiMeetingApp_b4714f94 .welcomePanel_b4714f94 .featureList_b4714f94{list-style:none;margin:0;padding:0}.teamsAiMeetingApp_b4714f94 .welcomePanel_b4714f94 .featureList_b4714f94 li{-ms-flex-align:center;align-items:center;border-bottom:1px solid;display:-ms-flexbox;display:flex;font-size:14px;font-weight:400;gap:12px;padding:12px 0}.teamsAiMeetingApp_b4714f94 .welcomePanel_b4714f94 .featureList_b4714f94 li:last-child{border-bottom:none}.teamsAiMeetingApp_b4714f94 .welcomePanel_b4714f94 .stepsList_b4714f94{font-size:14px;font-weight:400;line-height:1.6}.teamsAiMeetingApp_b4714f94 .welcomePanel_b4714f94 .stepsList_b4714f94 li{margin-bottom:8px;padding:8px 0}.teamsAiMeetingApp_b4714f94 .meetingPanel_b4714f94 .section_b4714f94:first-child{margin-top:0}',""]),e.exports=t},br4S:function(e,t){e.exports=i},fy5U:function(e,t,n){var a=n("ZYE7"),i=n("UxGz");"string"==typeof a&&(a=[[e.i,a]]);for(var r=0;r<a.length;r++)i.loadStyles(a[r][1],!0);a.locals&&(e.exports=a.locals)},owX6:function(e,t,n){"use strict";n.r(t);var a=n("UWqr"),i=n("26ea"),r=n("br4S");n("fy5U");var o,s="section_b4714f94",c="summarySection_b4714f94",d=n("qq0l"),l=(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},o(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),u=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},f=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.meetingId="",t.teamName="",t.isInMeeting=!1,t}return l(t,e),t.prototype.render=function(){var e="Welcome to Teams AI Meeting Assistant",t="Ready to enhance your meeting experience",n="";if(this.context.sdks.microsoftTeams){var a=this.context.sdks.microsoftTeams.context;a.meetingId?(this.meetingId=a.meetingId,e="AI Meeting Assistant Active",t="Meeting in progress - Transcription and AI features available",n="Meeting ID: ".concat(this.meetingId),this.isInMeeting=!0):a.teamName&&(this.teamName=a.teamName,e="AI Meeting Assistant",t="Ready for ".concat(this.teamName," meetings"),n="Team: ".concat(this.teamName))}this.domElement.innerHTML='\n      <div class="'.concat("teamsAiMeetingApp_b4714f94",'">\n        <div class="').concat("container_b4714f94",'">\n          <div class="').concat("row_b4714f94",'">\n            <div class="').concat("column_b4714f94",'">\n              <div class="').concat("header_b4714f94",'">\n                <span class="').concat("title_b4714f94",'">').concat(e,'</span>\n                <p class="').concat("subTitle_b4714f94",'">').concat(t,"</p>\n                ").concat(n?'<p class="'.concat("meetingInfo_b4714f94",'">').concat(n,"</p>"):"",'\n              </div>\n              \n              <div class="').concat("content_b4714f94",'">\n                ').concat(this.isInMeeting?this.renderMeetingContent():this.renderWelcomeContent(),"\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>"),this.addEventListeners()},t.prototype.renderMeetingContent=function(){return'\n      <div class="'.concat("meetingPanel_b4714f94",'">\n        <div class="').concat(s,'">\n          <h3>Meeting Status</h3>\n          <div class="').concat("statusIndicator_b4714f94",'">\n            <span class="').concat("statusDot_b4714f94"," ").concat("active_b4714f94",'"></span>\n            <span>Meeting Active</span>\n          </div>\n        </div>\n\n        <div class="').concat(s,'">\n          <h3>Transcription & AI Summary</h3>\n          <div class="').concat("transcriptionPanel_b4714f94",'">\n            <div id="transcriptionStatus" class="').concat("status_b4714f94",'">\n              Ready to capture meeting transcription...\n            </div>\n            <button id="getTranscriptionBtn" class="').concat("button_b4714f94"," ").concat("primary_b4714f94",'">\n              Get Post-Meeting Transcription\n            </button>\n          </div>\n        </div>\n\n        <div class="').concat(s,'">\n          <h3>AI Summary</h3>\n          <div id="summaryPanel" class="').concat("summaryPanel_b4714f94",'">\n            <div id="summaryContent" class="').concat("summaryContent_b4714f94",'">\n              Meeting summary will appear here after transcription is processed...\n            </div>\n            <div id="summaryLoading" class="').concat("loading_b4714f94",'" style="display: none;">\n              <div class="').concat("spinner_b4714f94",'"></div>\n              <span>Generating AI summary...</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    ')},t.prototype.renderWelcomeContent=function(){return'\n      <div class="'.concat("welcomePanel_b4714f94",'">\n        <div class="').concat(s,'">\n          <h3>Features</h3>\n          <ul class="').concat("featureList_b4714f94",'">\n            <li>📝 Automatic meeting transcription capture</li>\n            <li>🤖 AI-powered meeting summaries</li>\n            <li>📊 Key insights and action items</li>\n            <li>🔗 Integration with custom AI service</li>\n          </ul>\n        </div>\n        \n        <div class="').concat(s,'">\n          <h3>How it works</h3>\n          <ol class="').concat("stepsList_b4714f94",'">\n            <li>Join a Teams meeting with this app installed</li>\n            <li>After the meeting ends, click "Get Transcription"</li>\n            <li>AI will automatically generate a comprehensive summary</li>\n            <li>View insights, action items, and key discussion points</li>\n          </ol>\n        </div>\n      </div>\n    ')},t.prototype.addEventListeners=function(){var e=this,t=this.domElement.querySelector("#getTranscriptionBtn");t&&t.addEventListener("click",function(){e.getTranscriptionAndSummarize()})},t.prototype.getTranscriptionAndSummarize=function(){return u(this,void 0,void 0,function(){var e,t,n,a,i,r,o;return f(this,function(s){switch(s.label){case 0:if(e=this.domElement.querySelector("#transcriptionStatus"),t=this.domElement.querySelector("#summaryContent"),n=this.domElement.querySelector("#summaryLoading"),a=this.domElement.querySelector("#getTranscriptionBtn"),!(e&&t&&n&&a))return[2];s.label=1;case 1:return s.trys.push([1,4,5,6]),a.disabled=!0,a.textContent="Processing...",e.textContent="Fetching meeting transcription...",n.style.display="flex",t.textContent="Processing transcription...",[4,this.getMeetingTranscription()];case 2:return(i=s.sent())?(e.textContent="Transcription retrieved successfully. Generating AI summary...",[4,this.sendToAIService(i)]):(e.textContent="No transcription available yet. Please try again later.",t.textContent="Transcription not ready. Please wait for the meeting to end and try again.",[2]);case 3:return r=s.sent(),e.textContent="AI summary generated successfully!",t.innerHTML=this.formatAISummary(r),[3,6];case 4:return o=s.sent(),console.error("Error processing transcription:",o),e.textContent="Error processing transcription. Please try again.",t.textContent="Failed to generate summary. Please try again later.",[3,6];case 5:return n.style.display="none",a.disabled=!1,a.textContent="Get Post-Meeting Transcription",[7];case 6:return[2]}})})},t.prototype.getMeetingTranscription=function(){return u(this,void 0,void 0,function(){var e,t,n,a,i,r;return f(this,function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),this.meetingId?(console.log("Fetching transcription for meeting: ".concat(this.meetingId)),[4,this.context.msGraphClientFactory.getClient("3")]):(console.warn("No meeting ID available for transcription"),[2,null]);case 1:return e=o.sent(),console.log("Fetching meeting transcripts..."),[4,e.api("/me/onlineMeetings/".concat(this.meetingId,"/transcripts")).get()];case 2:return(t=o.sent()).value&&0!==t.value.length?(n=t.value[0],console.log("Found transcript: ".concat(n.id)),console.log("Fetching transcript content..."),[4,e.api("/me/onlineMeetings/".concat(this.meetingId,"/transcripts/").concat(n.id,"/content")).get()]):(console.warn("No transcripts found for this meeting"),[2,"No transcription available yet. Please ensure the meeting has ended and transcription was enabled during the meeting."]);case 3:return(a=o.sent())?(i="string"==typeof a?this.parseVTTTranscript(a):this.parseJSONTranscript(a),console.log("Successfully retrieved transcript content"),[2,i]):(console.warn("Transcript content is empty"),[2,"Transcript content is not available yet. Please try again later."]);case 4:return r=o.sent(),console.error("Error fetching transcription from Graph API:",r),"Forbidden"===r.code||"Unauthorized"===r.code?[2,"Access denied. Please ensure you have the necessary permissions to read meeting transcripts (OnlineMeetings.Read, OnlineMeetingTranscript.Read.All)."]:"NotFound"===r.code?[2,"Meeting or transcript not found. Please ensure the meeting ID is correct and transcription was enabled."]:"BadRequest"===r.code?[2,"Invalid meeting ID format or transcript not ready yet."]:[2,"Error retrieving transcript: ".concat(r.message||"Unknown error occurred")];case 5:return[2]}})})},t.prototype.parseVTTTranscript=function(e){try{for(var t=e.split("\n"),n=[],a="",i="",r=0;r<t.length;r++){var o=t[r].trim();if(!o.startsWith("WEBVTT")&&!o.includes("--\x3e")&&""!==o)if(o.includes(":")){i&&(n.push("".concat(a,": ").concat(i)),i="");var s=o.match(/^([^:]+):\s*(.*)$/);s&&(a=s[1].trim(),i=s[2].trim())}else a&&(i+=" "+o)}return i&&a&&n.push("".concat(a,": ").concat(i)),n.join("\n")}catch(t){return console.error("Error parsing VTT transcript:",t),e}},t.prototype.parseJSONTranscript=function(e){try{return e.transcript?e.transcript:e.transcripts&&Array.isArray(e.transcripts)?e.transcripts.map(function(e){return"".concat(e.speaker||"Unknown",": ").concat(e.text||"")}).join("\n"):e.value&&Array.isArray(e.value)?e.value.map(function(e){return"".concat(e.speaker||"Unknown",": ").concat(e.text||"")}).join("\n"):"string"==typeof e?e:JSON.stringify(e,null,2)}catch(t){return console.error("Error parsing JSON transcript:",t),JSON.stringify(e,null,2)}},t.prototype.sendToAIService=function(e){return u(this,void 0,void 0,function(){var t,n,a;return f(this,function(i){switch(i.label){case 0:t="https://al-meeting-agentassistant-hdhzh7eeb4g8c0fn.westeurope-01.azurewebsites.net/summarise",i.label=1;case 1:return i.trys.push([1,4,,5]),[4,fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcription:e,meetingId:this.meetingId,timestamp:(new Date).toISOString()})})];case 2:if(!(n=i.sent()).ok)throw new Error("AI service responded with status: ".concat(n.status));return[4,n.json()];case 3:return[2,i.sent()];case 4:return a=i.sent(),console.error("Error calling AI service:",a),[2,this.generateMockSummary(e)];case 5:return[2]}})})},t.prototype.generateMockSummary=function(e){return{summary:"This quarterly review meeting covered strong Q3 performance with sales exceeding targets by 15% and customer satisfaction improving to 4.7/5. The team discussed Q4 strategy focusing on European market expansion with necessary language localization.",keyPoints:["Q3 sales exceeded targets by 15%","Customer satisfaction improved from 4.2 to 4.7 out of 5","European market expansion identified as Q4 priority","Language localization requirements need to be addressed","3-month development timeline estimated for core features"],actionItems:[{task:"Prepare detailed European market analysis",assignee:"Sarah",dueDate:"Next week"},{task:"Plan user testing in parallel with development",assignee:"Lisa",dueDate:"To be scheduled"},{task:"Schedule follow-up meetings for Q4 initiatives",assignee:"John",dueDate:"This week"}],sentiment:"Positive",duration:"Estimated 30 minutes",participants:["John","Sarah","Mike","Lisa"]}},t.prototype.formatAISummary=function(e){return'\n      <div class="'.concat("summaryFormatted_b4714f94",'">\n        <div class="').concat(c,'">\n          <h4>📋 Meeting Summary</h4>\n          <p>').concat(e.summary,'</p>\n        </div>\n        \n        <div class="').concat(c,'">\n          <h4>🔑 Key Points</h4>\n          <ul>\n            ').concat(e.keyPoints.map(function(e){return"<li>".concat(e,"</li>")}).join(""),'\n          </ul>\n        </div>\n        \n        <div class="').concat(c,'">\n          <h4>✅ Action Items</h4>\n          <div class="').concat("actionItems_b4714f94",'">\n            ').concat(e.actionItems.map(function(e){return'\n              <div class="'.concat("actionItem_b4714f94",'">\n                <strong>').concat(e.task,'</strong><br>\n                <span class="').concat("assignee_b4714f94",'">Assigned to: ').concat(e.assignee,'</span><br>\n                <span class="').concat("dueDate_b4714f94",'">Due: ').concat(e.dueDate,"</span>\n              </div>\n            ")}).join(""),'\n          </div>\n        </div>\n        \n        <div class="').concat(c,'">\n          <h4>📊 Meeting Insights</h4>\n          <p><strong>Sentiment:</strong> ').concat(e.sentiment,"</p>\n          <p><strong>Duration:</strong> ").concat(e.duration,"</p>\n          <p><strong>Participants:</strong> ").concat(e.participants.join(", "),"</p>\n        </div>\n      </div>\n    ")},t.prototype.delay=function(e){return new Promise(function(t){return setTimeout(t,e)})},Object.defineProperty(t.prototype,"dataVersion",{get:function(){return a.Version.parse("1.0")},enumerable:!1,configurable:!0}),t.prototype.getPropertyPaneConfiguration=function(){return{pages:[{header:{description:d.PropertyPaneDescription},groups:[{groupName:d.BasicGroupName,groupFields:[Object(i.PropertyPaneTextField)("description",{label:d.DescriptionFieldLabel})]}]}]}},t}(r.BaseClientSideWebPart);t.default=p},qq0l:function(e,t){e.exports=r},yLpj:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n}})});